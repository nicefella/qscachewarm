{"version":3,"file":"enigma.js","sources":["node_modules/extend/index.js","src/json-patch.js","node_modules/node-event-emitter/index.js","src/event-emitter.js","src/session.js","src/cache.js","src/schema.js","src/rpc-resolver.js","src/rpc.js","src/suspend-resume.js","src/intercept.js","src/api-cache.js","src/qix.js"],"sourcesContent":["'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) { /**/ }\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone;\n\tvar target = arguments[0];\n\tvar i = 1;\n\tvar length = arguments.length;\n\tvar deep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\tif (target == null || (typeof target !== 'object' && typeof target !== 'function')) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n","import originalExtend from 'extend';\n\nconst extend = originalExtend.bind(null, true);\nconst JSONPatch = {};\nconst isArray = Array.isArray;\nfunction isObject(v) { return v != null && !Array.isArray(v) && typeof v === 'object'; }\nfunction isUndef(v) { return typeof v === 'undefined'; }\nfunction isFunction(v) { return typeof v === 'function'; }\n\n/**\n* Generate an exact duplicate (with no references) of a specific value.\n*\n* @private\n* @param {Object} The value to duplicate\n* @returns {Object} a unique, duplicated value\n*/\nfunction generateValue(val) {\n  if (val) {\n    val = extend({}, { val }).val;\n  }\n  return val;\n}\n\n/**\n* An additional type checker used to determine if the property is of internal\n* use or not a type that can be translated into JSON (like functions).\n*\n* @private\n* @param {Object} obj The object which has the property to check\n* @param {String} The property name to check\n* @returns {Boolean} Whether the property is deemed special or not\n*/\nfunction isSpecialProperty(obj, key) {\n  return isFunction(obj[key]) ||\n    key.substring(0, 2) === '$$' ||\n    key.substring(0, 1) === '_';\n}\n\n/**\n* Finds the parent object from a JSON-Pointer (\"/foo/bar/baz\" = \"bar\" is \"baz\" parent),\n* also creates the object structure needed.\n*\n* @private\n* @param {Object} data The root object to traverse through\n* @param {String} The JSON-Pointer string to use when traversing\n* @returns {Object} The parent object\n*/\nfunction getParent(data, str) {\n  const seperator = '/';\n  const parts = str.substring(1).split(seperator).slice(0, -1);\n  let numPart;\n\n  parts.forEach((part, i) => {\n    if (i === parts.length) {\n      return;\n    }\n    numPart = +part;\n    const newPart = !isNaN(numPart) ? [] : {};\n    data[numPart || part] = isUndef(data[numPart || part]) ?\n      newPart :\n      data[part];\n    data = data[numPart || part];\n  });\n\n  return data;\n}\n\n/**\n* Cleans an object of all its properties, unless they're deemed special or\n* cannot be removed by configuration.\n*\n* @private\n* @param {Object} obj The object to clean\n*/\nfunction emptyObject(obj) {\n  Object.keys(obj).forEach((key) => {\n    const config = Object.getOwnPropertyDescriptor(obj, key);\n\n    if (config.configurable && !isSpecialProperty(obj, key)) {\n      delete obj[key];\n    }\n  });\n}\n\n/**\n* Compare an object with another, could be object, array, number, string, bool.\n*\n* @param {Object} a The first object to compare\n* @param {Object} a The second object to compare\n* @returns {Boolean} Whether the objects are identical\n*/\nfunction compare(a, b) {\n  let isIdentical = true;\n\n  if (isObject(a) && isObject(b)) {\n    if (Object.keys(a).length !== Object.keys(b).length) {\n      return false;\n    }\n    Object.keys(a).forEach((key) => {\n      if (!compare(a[key], b[key])) {\n        isIdentical = false;\n      }\n    });\n    return isIdentical;\n  } else if (isArray(a) && isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0, l = a.length; i < l; i += 1) {\n      if (!compare(a[i], b[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return a === b;\n}\n\n/**\n* Generates patches by comparing two arrays.\n*\n* @private\n* @param {Array} oldA The old (original) array, which will be patched\n* @param {Array} newA The new array, which will be used to compare against\n* @returns {Array} An array of patches (if any)\n*/\nfunction patchArray(original, newA, basePath) {\n  let patches = [];\n  const oldA = original.slice();\n  let tmpIdx = -1;\n\n  function findIndex(a, id, idx) {\n    if (a[idx] && isUndef(a[idx].qInfo)) {\n      return null;\n    } else if (a[idx] && a[idx].qInfo.qId === id) {\n      // shortcut if identical\n      return idx;\n    }\n    for (let ii = 0, ll = a.length; ii < ll; ii += 1) {\n      if (a[ii] && a[ii].qInfo.qId === id) {\n        return ii;\n      }\n    }\n    return -1;\n  }\n\n  if (compare(newA, oldA)) {\n    // array is unchanged\n    return patches;\n  }\n\n  if (!isUndef(newA[0]) && isUndef(newA[0].qInfo)) {\n    // we cannot create patches without unique identifiers, replace array...\n    patches.push({\n      op: 'replace',\n      path: basePath,\n      value: newA,\n    });\n    return patches;\n  }\n\n  for (let i = oldA.length - 1; i >= 0; i -= 1) {\n    tmpIdx = findIndex(newA, oldA[i].qInfo && oldA[i].qInfo.qId, i);\n    if (tmpIdx === -1) {\n      patches.push({\n        op: 'remove',\n        path: `${basePath}/${i}`,\n      });\n      oldA.splice(i, 1);\n    } else {\n      patches = patches.concat(JSONPatch.generate(oldA[i], newA[tmpIdx], `${basePath}/${i}`));\n    }\n  }\n\n  for (let i = 0, l = newA.length; i < l; i += 1) {\n    tmpIdx = findIndex(oldA, newA[i].qInfo && newA[i].qInfo.qId);\n    if (tmpIdx === -1) {\n      patches.push({\n        op: 'add',\n        path: `${basePath}/${i}`,\n        value: newA[i],\n      });\n      oldA.splice(i, 0, newA[i]);\n    } else if (tmpIdx !== i) {\n      patches.push({\n        op: 'move',\n        path: `${basePath}/${i}`,\n        from: `${basePath}/${tmpIdx}`,\n      });\n      oldA.splice(i, 0, oldA.splice(tmpIdx, 1)[0]);\n    }\n  }\n  return patches;\n}\n\n/**\n* Generate an array of JSON-Patch:es following the JSON-Patch Specification Draft.\n*\n* See [specification draft](http://tools.ietf.org/html/draft-ietf-appsawg-json-patch-10)\n*\n* Does NOT currently generate patches for arrays (will replace them)\n*\n* @param {Object} original The object to patch to\n* @param {Object} newData The object to patch from\n* @param {String} [basePath] The base path to use when generating the paths for\n*                            the patches (normally not used)\n* @returns {Array} An array of patches\n*/\nJSONPatch.generate = function generate(original, newData, basePath) {\n  basePath = basePath || '';\n  let patches = [];\n\n  Object.keys(newData).forEach((key) => {\n    const val = generateValue(newData[key]);\n    const oldVal = original[key];\n    const tmpPath = `${basePath}/${key}`;\n\n    if (compare(val, oldVal) || isSpecialProperty(newData, key)) {\n      return;\n    }\n    if (isUndef(oldVal)) {\n      // property does not previously exist\n      patches.push({\n        op: 'add',\n        path: tmpPath,\n        value: val,\n      });\n    } else if (isObject(val) && isObject(oldVal)) {\n      // we need to generate sub-patches for this, since it already exist\n      patches = patches.concat(JSONPatch.generate(oldVal, val, tmpPath));\n    } else if (isArray(val) && isArray(oldVal)) {\n      patches = patches.concat(patchArray(oldVal, val, tmpPath));\n    } else {\n      // it's a simple property (bool, string, number)\n      patches.push({\n        op: 'replace',\n        path: `${basePath}/${key}`,\n        value: val,\n      });\n    }\n  });\n\n  Object.keys(original).forEach((key) => {\n    if (isUndef(newData[key]) && !isSpecialProperty(original, key)) {\n      // this property does not exist anymore\n      patches.push({\n        op: 'remove',\n        path: `${basePath}/${key}`,\n      });\n    }\n  });\n\n  return patches;\n};\n\n/**\n* Apply a list of patches to an object.\n*\n* @param {Object} original The object to patch\n* @param {Array} patches The list of patches to apply\n*/\nJSONPatch.apply = function apply(original, patches) {\n  patches.forEach((patch) => {\n    let parent = getParent(original, patch.path);\n    let key = patch.path.split('/').splice(-1)[0];\n    let target = key && isNaN(+key) ? parent[key] : parent[+key] || parent;\n    const from = patch.from ? patch.from.split('/').splice(-1)[0] : null;\n\n    if (patch.path === '/') {\n      parent = null;\n      target = original;\n    }\n\n    if (patch.op === 'add' || patch.op === 'replace') {\n      if (isArray(parent)) {\n        // trust indexes from patches, so don't replace the index if it's an add\n        if (key === '-') {\n          key = parent.length;\n        }\n        parent.splice(+key, patch.op === 'add' ? 0 : 1, patch.value);\n      } else if (isArray(target) && isArray(patch.value)) {\n        const newValues = patch.value.slice();\n        // keep array reference if possible...\n        target.length = 0;\n        target.push(...newValues);\n      } else if (isObject(target) && isObject(patch.value)) {\n        // keep object reference if possible...\n        emptyObject(target);\n        extend(target, patch.value);\n      } else if (!parent) {\n        throw new Error('Patchee is not an object we can patch');\n      } else {\n        // simple value\n        parent[key] = patch.value;\n      }\n    } else if (patch.op === 'move') {\n      const oldParent = getParent(original, patch.from);\n      if (isArray(parent)) {\n        parent.splice(+key, 0, oldParent.splice(+from, 1)[0]);\n      } else {\n        parent[key] = oldParent[from];\n        delete oldParent[from];\n      }\n    } else if (patch.op === 'remove') {\n      if (isArray(parent)) {\n        parent.splice(+key, 1);\n      } else {\n        delete parent[key];\n      }\n    }\n  });\n};\n\n/**\n* Deep clone an object.\n*\n* @param {Object} obj The object to clone\n* @returns {Object} A new object identical to the `obj`\n*/\nJSONPatch.clone = function clone(obj) {\n  return extend({}, obj);\n};\n\n/**\n* Creates a JSON-patch.\n*\n* @param {String} op The operation of the patch. Available values: \"add\", \"remove\", \"move\"\n* @param {Object} [val] The value to set the `path` to. If `op` is `move`, `val`\n*                       is the \"from JSON-path\" path\n* @param {String} path The JSON-path for the property to change (e.g. \"/qHyperCubeDef/columnOrder\")\n* @returns {Object} A patch following the JSON-patch specification\n*/\nJSONPatch.createPatch = function createPatch(op, val, path) {\n  const patch = {\n    op: op.toLowerCase(),\n    path,\n  };\n  if (patch.op === 'move') {\n    patch.from = val;\n  } else if (typeof val !== 'undefined') {\n    patch.value = val;\n  }\n  return patch;\n};\n\n/**\n* Apply the differences of two objects (keeping references if possible).\n* Identical to running `JSONPatch.apply(original, JSONPatch.generate(original, newData));`\n*\n* @param {Object} original The object to update/patch\n* @param {Object} newData the object to diff against\n*\n* @example\n* var obj1 = { foo: [1,2,3], bar: { baz: true, qux: 1 } };\n* var obj2 = { foo: [4,5,6], bar: { baz: false } };\n* JSONPatch.updateObject(obj1, obj2);\n* // => { foo: [4,5,6], bar: { baz: false } };\n*/\nJSONPatch.updateObject = function updateObject(original, newData) {\n  if (!Object.keys(original).length) {\n    extend(original, newData);\n    return;\n  }\n  JSONPatch.apply(original, JSONPatch.generate(original, newData));\n};\n\nexport default JSONPatch;\n","/**\n * Utility functions\n */\n\nvar util = {};\n\nutil.isObject = function isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nutil.isNumber = function isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nutil.isUndefined = function isUndefined(arg) {\n  return arg === void 0;\n}\n\nutil.isFunction = function isFunction(arg){\n  return typeof arg === 'function';\n}\n\n\n/**\n * EventEmitter class\n */\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\nEventEmitter.init = function() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!util.isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error' && !this._events.error) {\n    er = arguments[1];\n    if (er instanceof Error) {\n      throw er; // Unhandled 'error' event\n    } else {\n      throw Error('Uncaught, unspecified \"error\" event.');\n    }\n    return false;\n  }\n\n  handler = this._events[type];\n\n  if (util.isUndefined(handler))\n    return false;\n\n  if (util.isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (util.isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!util.isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              util.isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (util.isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (util.isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!util.isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n\n      if (util.isFunction(console.error)) {\n        console.error('(node) warning: possible EventEmitter memory ' +\n                      'leak detected. %d listeners added. ' +\n                      'Use emitter.setMaxListeners() to increase limit.',\n                      this._events[type].length);\n      }\n      if (util.isFunction(console.trace))\n        console.trace();\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!util.isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!util.isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (util.isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (util.isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (util.isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (Array.isArray(listeners)) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (util.isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (util.isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n","import EventEmitter from 'node-event-emitter';\n\n/**\n* @module EventEmitter\n*/\nexport default {\n\n  /**\n  * Function used to add event handling to objects passed in.\n  * @param {Object} obj Object instance that will get event handling.\n  */\n  mixin: (obj) => {\n    Object.keys(EventEmitter.prototype).forEach((key) => {\n      obj[key] = EventEmitter.prototype[key];\n    });\n    EventEmitter.init(obj);\n  },\n};\n","import EventEmitter from './event-emitter';\n\nconst RPC_CLOSE_NORMAL = 1000;\nconst RPC_CLOSE_MANUAL_SUSPEND = 4000;\n\nclass Session {\n  /**\n  * Creates a new Session instance.\n  * @param {Object} options The configuration option for this class.\n  * @param {Intercept} options.intercept The intercept instance to use.\n  * @param {ApiCache} options.apis The ApiCache instance to bridge events towards.\n  * @param {Promise} options.Promise The promise constructor to use.\n  * @param {RPC} options.rpc The RPC instance to use when communicating towards Engine.\n  * @param {Schema} options.definition The Schema instance to use when generating APIs.\n  * @param {Object} options.protocol Additional protocol properties.\n  * @param {Boolean} options.protocol.delta Flag indicating if delta should be used or not.\n  * @param {SuspendResume} options.suspendResume The SuspendResume instance to use.\n  * @param {Object} [options.eventListeners] An object containing keys (event names) and\n  *                                          values (event handlers) that will be bound\n  *                                          during instantiation.\n  */\n  constructor(options) {\n    const session = this;\n    Object.assign(session, options);\n    EventEmitter.mixin(session);\n    session.rpc.on('socket-error', session.onRpcError.bind(session));\n    session.rpc.on('closed', session.onRpcClosed.bind(session));\n    session.rpc.on('message', session.onRpcMessage.bind(session));\n    session.rpc.on('notification', session.onRpcNotification.bind(session));\n    session.rpc.on('traffic', session.onRpcTraffic.bind(session));\n    session.on('closed', () => session.onSessionClosed());\n  }\n\n  /**\n  * Event handler for re-triggering error events from RPC.\n  * @emits socket-error\n  * @param {Error} err Webocket error event.\n  */\n  onRpcError(err) {\n    if (this.suspendResume.isSuspended) {\n      return;\n    }\n    this.emit('socket-error', err);\n  }\n\n  /**\n  * Event handler for the RPC close event.\n  * @emits suspended\n  * @emits closed\n  * @param {Event} evt WebSocket close event.\n  */\n  onRpcClosed(evt) {\n    if (this.suspendResume.isSuspended) {\n      return;\n    }\n    if (evt.code === RPC_CLOSE_NORMAL || evt.code === RPC_CLOSE_MANUAL_SUSPEND) {\n      return;\n    }\n    if (this.suspendOnClose) {\n      this.suspendResume.suspend().then(() => this.emit('suspended', { initiator: 'network' }));\n    } else {\n      this.emit('closed', evt);\n    }\n  }\n\n  /**\n  * Event handler for the RPC message event.\n  * @param {Object} response JSONRPC response.\n  */\n  onRpcMessage(response) {\n    if (this.suspendResume.isSuspended) {\n      return;\n    }\n    if (response.change) {\n      response.change.forEach(handle => this.emitHandleChanged(handle));\n    }\n    if (response.close) {\n      response.close.forEach(handle => this.emitHandleClosed(handle));\n    }\n  }\n\n  /**\n  * Event handler for the RPC notification event.\n  * @emits notification:*\n  * @emits notification:[JSONRPC notification name]\n  * @param {Object} response The JSONRPC notification.\n  */\n  onRpcNotification(response) {\n    this.emit('notification:*', response.method, response.params);\n    this.emit(`notification:${response.method}`, response.params);\n  }\n\n  /**\n  * Event handler for the RPC traffic event.\n  * @emits traffic:*\n  * @emits traffic:sent\n  * @emits traffic:received\n  * @param {String} dir The traffic direction, sent or received.\n  * @param {Object} data JSONRPC request/response/WebSocket message.\n  */\n  onRpcTraffic(dir, data) {\n    this.emit('traffic:*', dir, data);\n    this.emit(`traffic:${dir}`, data);\n  }\n\n  /**\n  * Event handler for cleaning up API instances when a session has been closed.\n  * @emits api#closed\n  */\n  onSessionClosed() {\n    this.apis.getApis().forEach((entry) => {\n      entry.api.emit('closed');\n      entry.api.removeAllListeners();\n    });\n    this.apis.clear();\n  }\n\n  /**\n   * Function used to get an API for a backend object.\n   * @param {Object} args Arguments used to create object API.\n   * @param {Number} args.handle Handle of the backend object.\n   * @param {String} args.id ID of the backend object.\n   * @param {String} args.type QIX type of the backend object. Can for example\n   *                           be \"Doc\" or \"GenericVariable\".\n   * @param {String} args.genericType Custom type of the backend object, if defined in qInfo.\n   * @returns {*} Returns the generated and possibly augmented API.\n   */\n  getObjectApi(args) {\n    const { handle, id, type, genericType } = args;\n    let api = this.apis.getApi(handle);\n    if (api) {\n      return api;\n    }\n    api = this.definition\n      .generate(type)\n      .create(this, handle, id, this.protocol.delta, genericType);\n    this.apis.add(handle, api);\n    return api;\n  }\n\n  /**\n  * Response handler for generating APIs. Handles the quirks of engine not returning an error\n  * when an object is missing.\n  * @param {Object} response The response message.\n  * @returns {Promise} A promise that resolves with the created object.\n  */\n  handleObjectReferenceResponse(response) {\n    if (response.qHandle && response.qType) {\n      return this.getObjectApi({\n        handle: response.qHandle,\n        type: response.qType,\n        id: response.qGenericId,\n        genericType: response.qGenericType,\n      });\n    }\n    return this.Promise.reject(new Error('Object not found'));\n  }\n\n  /**\n  * Establishes the RPC socket connection and returns the Global instance.\n  * @returns {Promise} Eventually resolved if the connection was successful.\n  */\n  open() {\n    if (!this.globalPromise) {\n      const args = { handle: -1, id: 'Global', type: 'Global', genericType: 'Global' };\n      this.globalPromise = this.rpc.open()\n        .then(() => this.getObjectApi(args))\n        .then((global) => {\n          this.emit('opened');\n          return global;\n        });\n    }\n    return this.globalPromise;\n  }\n\n  /**\n  * Function used to send data on the RPC socket.\n  * @param {Object} request The request to be sent. (data and some meta info)\n  * @returns {Object} Returns a promise instance.\n  */\n  send(request) {\n    if (this.suspendResume.isSuspended) {\n      return this.Promise.reject(new Error('Session suspended'));\n    }\n    const data = Object.assign({}, this.protocol, {\n      method: request.method,\n      handle: request.handle,\n      params: request.params,\n      delta: request.delta,\n    });\n    const response = this.rpc.send(data);\n    request.id = data.id;\n    request.retry = () => this.send(request);\n\n    const promise = this.intercept.execute(this, response, request).then((res) => {\n      if (typeof res.qHandle !== 'undefined' && typeof res.qType !== 'undefined') {\n        return this.handleObjectReferenceResponse(res);\n      }\n      return res;\n    });\n    Session.addToPromiseChain(promise, 'requestId', request.id);\n    return promise;\n  }\n\n  /**\n  * Suspends the session (\"sleeping state\"), and closes the RPC connection.\n  * @emits suspended\n  * @returns {Promise} Eventually resolved when the RPC connection is closed.\n  */\n  suspend() {\n    return this.suspendResume.suspend()\n      .then(() => this.emit('suspended', { initiator: 'manual' }));\n  }\n\n  /**\n  * Resumes a previously suspended session.\n  * @param {Boolean} onlyIfAttached If true, resume only if the session was re-attached.\n  * @returns {Promise} Eventually resolved if the session was successfully resumed,\n  *                    otherwise rejected.\n  */\n  resume(onlyIfAttached) {\n    return this.suspendResume.resume(onlyIfAttached).then((value) => {\n      this.emit('resumed');\n      return value;\n    });\n  }\n\n  /**\n  * Function used to close the session.\n  * @returns {Promise} Eventually resolved when the RPC connection is closed.\n  */\n  close() {\n    this.globalPromise = undefined;\n    return this.rpc.close().then(evt => this.emit('closed', evt));\n  }\n\n  /**\n  * Given a handle, this function will emit the 'changed' event on the\n  * corresponding API instance.\n  * @param {Number} handle The handle of the API instance.\n  * @emits api#changed\n  */\n  emitHandleChanged(handle) {\n    const api = this.apis.getApi(handle);\n    if (api) {\n      api.emit('changed');\n    }\n  }\n\n  /**\n  * Given a handle, this function will emit the 'closed' event on the\n  * corresponding API instance.\n  * @param {Number} handle The handle of the API instance.\n  * @emits api#closed\n  */\n  emitHandleClosed(handle) {\n    const api = this.apis.getApi(handle);\n    if (api) {\n      api.emit('closed');\n      api.removeAllListeners();\n    }\n  }\n\n  /**\n  * Function used to add info on the promise chain.\n  * @private\n  * @param {Promise} promise The promise to add info on.\n  * @param {String} name The property to add info on.\n  * @param {Any} value The info to add.\n  */\n  static addToPromiseChain(promise, name, value) {\n    promise[name] = value;\n    const then = promise.then;\n    promise.then = function patchedThen(...params) {\n      const chain = then.apply(this, params);\n      Session.addToPromiseChain(chain, name, value);\n      return chain;\n    };\n  }\n}\n\nexport default Session;\n","/**\n* Key-value cache\n*/\nclass KeyValueCache {\n  constructor() {\n    this.entries = {};\n  }\n\n  /**\n  * Adds an entry.\n  * @function KeyValueCache#add\n  * @param {String} key The key representing an entry.\n  * @param {*} entry The entry to be added.\n  */\n  add(key, entry) {\n    key += '';\n    if (typeof this.entries[key] !== 'undefined') {\n      throw new Error(`Entry already defined with key ${key}`);\n    }\n    this.entries[key] = entry;\n  }\n\n  /**\n  * Sets an entry.\n  * @function KeyValueCache#set\n  * @param {String} key The key representing an entry.\n  * @param {*} entry The entry.\n  */\n  set(key, entry) {\n    key += '';\n    this.entries[key] = entry;\n  }\n\n  /**\n  * Removes an entry.\n  * @function KeyValueCache#remove\n  * @param {String} key The key representing an entry.\n  */\n  remove(key) {\n    delete this.entries[key];\n  }\n\n  /**\n  * Gets an entry.\n  * @function KeyValueCache#get\n  * @param {String} key The key representing an entry.\n  * @returns {*} The entry for the key.\n  */\n  get(key) {\n    return this.entries[key];\n  }\n\n  /**\n  * Gets a list of all entries.\n  * @function KeyValueCache#getAll\n  * @returns {Array} The list of entries including its `key` and `value` properties.\n  */\n  getAll() {\n    return Object.keys(this.entries).map(key =>\n      ({\n        key,\n        value: this.entries[key],\n      }),\n    );\n  }\n\n  /**\n  * Gets a key for an entry.\n  * @function KeyValueCache#getKey\n  * @param {*} entry The entry to locate the key for.\n  * @returns {String} The key representing an entry.\n  */\n  getKey(entry) {\n    return Object.keys(this.entries).filter(key =>\n      this.entries[key] === entry,\n    )[0];\n  }\n\n  /**\n  * Clears the cache of all entries.\n  * @function KeyValueCache#clear\n  */\n  clear() {\n    this.entries = {};\n  }\n}\n\nexport default KeyValueCache;\n","import KeyValueCache from './cache';\nimport Events from './event-emitter';\n\nconst IGNORE_DELTA_METHODS = [\n  'GetProperties',\n  'SetProperties',\n  'GetFullPropertyTree',\n  'SetFullPropertyTree',\n  'GetAppProperties',\n  'SetAppProperties',\n];\n\nconst SUCCESS_KEY = 'qSuccess';\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\n/**\n* Returns the camelCase counterpart of a symbol.\n* @param {String} symbol The symbol.\n* @return the camelCase counterpart.\n*/\nfunction toCamelCase(symbol) {\n  return symbol.substring(0, 1).toLowerCase() + symbol.substring(1);\n}\n\n/**\n * A facade function that allows parameters to be passed either by name\n * (through an object), or by position (through an array).\n * @param {Function} base The function that is being overriden. Will be\n *                        called with parameters in array-form.\n * @param {Object} defaults Parameter list and it's default values.\n * @param {*} params The parameters.\n */\nfunction namedParamFacade(base, defaults, ...params) {\n  if (params.length === 1 && typeof params[0] === 'object') {\n    const valid = Object.keys(params[0]).every(key => hasOwnProperty.call(defaults, key));\n    if (valid) {\n      params = Object.keys(defaults).map(key => params[0][key] || defaults[key]);\n    }\n  }\n  return base.apply(this, params);\n}\n\n/**\n* Qix schema definition.\n*/\nclass Schema {\n  /**\n  * Create a new schema instance.\n  * @param {Configuration} config The configuration for QIX.\n  */\n  constructor(config) {\n    this.config = config;\n    this.Promise = config.Promise;\n    this.schema = config.schema;\n    this.mixins = new KeyValueCache();\n    this.types = new KeyValueCache();\n  }\n\n  /**\n  * Function used to add a mixin object to the mixin cache. Will be mixed into the API\n  * of the specified key when generated.\n  * @param {Object} mixin Mixin object.\n  * @param {String|Array<String>} mixin.types String or array of strings containing the\n  *                                           API-types that will be mixed in.\n  * @param {Object} [mixin.extend] Object literal containing the methods that\n  *                                will be extended on the specified API.\n  * @param {Object} [mixin.override] Object literal containing the methods to\n  *                                  override existing methods.\n  * @param {Function} [mixin.init] Init function that, if defined, will run when an API is\n  *                                instantiated. It runs with Promise and API object as parameters.\n  */\n  registerMixin({ types, type, extend, override, init }) {\n    if (!Array.isArray(types)) {\n      types = [types];\n    }\n    // to support a single type\n    if (type) {\n      types.push(type);\n    }\n    const cached = { extend, override, init };\n    types.forEach((typeKey) => {\n      const entryList = this.mixins.get(typeKey);\n      if (entryList) {\n        entryList.push(cached);\n      } else {\n        this.mixins.add(typeKey, [cached]);\n      }\n    });\n  }\n\n  /**\n  * Function used to generate a type definition.\n  * @param {String} type The type.\n  * @returns {{create: Function, def: Object}} Returns an object with a definition\n  *          of the type and a create factory.\n  */\n  generate(type) {\n    const entry = this.types.get(type);\n    if (entry) {\n      return entry;\n    }\n    if (!this.schema.structs[type]) {\n      throw new Error(`${type} not found`);\n    }\n    const factory = this.generateApi(type, this.schema.structs[type]);\n    this.types.add(type, factory);\n    return factory;\n  }\n\n  /**\n  * Function used to generate an API definition for a given type.\n  * @param {String} type The type to generate.\n  * @param {Object} schema The schema describing the type.\n  * @returns {{create: (function(session:Object, handle:Number, id:String,\n  *          delta:Boolean, customKey:String)), def: Object}} Returns the API definition.\n  */\n  generateApi(type, schema) {\n    const api = Object.create({});\n\n    this.generateDefaultApi(api, schema); // Generate default\n    this.mixinType(type, api); // Mixin default type\n    this.mixinNamedParamFacade(api, schema); // Mixin named parameter support\n\n    const create = function create(session, handle, id, delta, customKey) {\n      const instance = Object.create(api);\n\n      Events.mixin(instance); // Always mixin event-emitter per instance\n\n      Object.defineProperties(instance, {\n        session: {\n          enumerable: true,\n          value: session,\n        },\n        handle: {\n          enumerable: true,\n          value: handle,\n          writable: true,\n        },\n        id: {\n          enumerable: true,\n          value: id,\n        },\n        delta: {\n          enumerable: true,\n          value: delta,\n        },\n        type: {\n          enumerable: true,\n          value: type,\n        },\n        genericType: {\n          enumerable: true,\n          value: customKey,\n        },\n      });\n\n      let mixinList = this.mixins.get(type) || [];\n      if (customKey !== type) {\n        this.mixinType(customKey, instance); // Mixin custom types\n        mixinList = mixinList.concat(this.mixins.get(customKey) || []);\n      }\n      mixinList.forEach((mixin) => {\n        if (typeof mixin.init === 'function') {\n          mixin.init({ config: this.config, api: instance });\n        }\n      });\n\n      return instance;\n    }.bind(this);\n\n    return {\n      create,\n      def: api,\n    };\n  }\n\n  /**\n  * Function used to generate the methods with the right handlers to the object\n  * API that is being generated.\n  * @param {Object} api The object API that is currently being generated.\n  * @param {Object} schema The API definition.\n  */\n  generateDefaultApi(api, schema) {\n    Object.keys(schema).forEach((key) => {\n      const fnName = toCamelCase(key);\n      const outKey = schema[key].Out && schema[key].Out.length === 1 ? schema[key].Out[0].Name : -1;\n\n      const allowDelta = IGNORE_DELTA_METHODS.indexOf(key) === -1 &&\n        outKey !== -1 &&\n        outKey !== SUCCESS_KEY;\n\n      function fn(...params) {\n        return this.session.send({\n          method: key,\n          handle: this.handle,\n          params,\n          delta: this.delta && allowDelta,\n          outKey,\n        });\n      }\n\n      Object.defineProperty(api, fnName, {\n        enumerable: true,\n        writable: true,\n        value: fn,\n      });\n    });\n  }\n\n  /**\n  * Function used to add mixin methods to a specified API.\n  * @param {String} type Used to specify which mixin should be woven in.\n  * @param {Object} api The object that will be woven.\n  */\n  mixinType(type, api) {\n    const mixinList = this.mixins.get(type);\n    if (mixinList) {\n      mixinList.forEach(({ extend = {}, override = {} }) => {\n        Object.keys(override).forEach((key) => {\n          if (typeof api[key] === 'function' && typeof override[key] === 'function') {\n            const baseFn = api[key];\n            api[key] = function wrappedFn(...args) {\n              return override[key].apply(this, [baseFn.bind(this), ...args]);\n            };\n          } else {\n            throw new Error(`No function to override. Type: ${type} function: ${key}`);\n          }\n        });\n        Object.keys(extend).forEach((key) => {\n          // handle overrides\n          if (typeof api[key] === 'function' && typeof extend[key] === 'function') {\n            throw new Error(`Extend is not allowed for this mixin. Type: ${type} function: ${key}`);\n          } else {\n            api[key] = extend[key];\n          }\n        });\n      });\n    }\n  }\n\n  /**\n  * Function used to mixin the named parameter facade.\n  * @param {Object} api The object API that is currently being generated.\n  * @param {Object} schema The API definition.\n  */\n  mixinNamedParamFacade(api, schema) {\n    Object.keys(schema).forEach((key) => {\n      const fnName = toCamelCase(key);\n      const base = api[fnName];\n      const defaults = schema[key].In.reduce((result, item) => {\n        result[item.Name] = item.DefaultValue;\n        return result;\n      }, {});\n\n      api[fnName] = function namedParamWrapper(...params) {\n        return namedParamFacade.apply(this, [base, defaults, ...params]);\n      };\n    });\n  }\n}\n\nexport default Schema;\n","import Events from './event-emitter';\n\n/**\n * Helper class for handling RPC calls\n */\nclass RPCResolver {\n  constructor(id, resolve, reject) {\n    Events.mixin(this);\n    this.id = id;\n    this.resolve = resolve;\n    this.reject = reject;\n  }\n  resolveWith(data) {\n    this.resolve(data);\n    this.emit('resolved', this.id);\n  }\n  rejectWith(err) {\n    this.reject(err);\n    this.emit('rejected', this.id);\n  }\n}\n\nexport default RPCResolver;\n","import Events from './event-emitter';\nimport RPCResolver from './rpc-resolver';\n\n/**\n* This class handles remote procedure calls on a web socket.\n*/\nclass RPC {\n  /**\n  * Create a new RPC instance.\n  * @param {Object} options The configuration options for this class.\n  * @param {Function} options.Promise The promise constructor to use.\n  * @param {String} options.url The complete websocket URL used to connect.\n  * @param {Function} options.createSocket The function callback to create a WebSocket.\n  */\n  constructor(options) {\n    Object.assign(this, options);\n    Events.mixin(this);\n    this.resolvers = {};\n    this.requestId = 0;\n    this.openedPromise = undefined;\n  }\n\n  /**\n  * Opens a connection to the configured endpoint.\n  * @param {Boolean} force - ignores all previous and outstanding open calls if set to true.\n  * @returns {Object} A promise instance.\n  */\n  open(force = false) {\n    if (!force && this.openedPromise) {\n      return this.openedPromise;\n    }\n\n    try {\n      this.socket = this.createSocket(this.url);\n    } catch (err) {\n      return this.Promise.reject(err);\n    }\n\n    this.socket.onopen = this.onOpen.bind(this);\n    this.socket.onclose = this.onClose.bind(this);\n    this.socket.onerror = this.onError.bind(this);\n    this.socket.onmessage = this.onMessage.bind(this);\n    this.openedPromise = new this.Promise((resolve, reject) => this.registerResolver('opened', resolve, reject));\n    this.closedPromise = new this.Promise((resolve, reject) => this.registerResolver('closed', resolve, reject));\n    return this.openedPromise;\n  }\n\n  /**\n  * Resolves the open promise when a connection is successfully established.\n  */\n  onOpen() {\n    this.resolvers.opened.resolveWith(\n      () => this.closedPromise,\n    );\n  }\n\n  /**\n  * Resolves the close promise when a connection is closed.\n  * @param {Object} event - The event describing close.\n  */\n  onClose(event) {\n    this.emit('closed', event);\n    this.resolvers.closed.resolveWith(event);\n    this.rejectAllOutstandingResolvers({ code: -1, message: 'Socket closed' });\n  }\n\n  /**\n  * Closes a connection.\n  * @param {Number} [code=1000] - The reason code for closing the connection.\n  * @param {String} [reason=\"\"] - The human readable string describing why the connection is closed.\n  * @returns {Object} Returns a promise instance.\n  */\n  close(code = 1000, reason = '') {\n    this.socket.close(code, reason);\n    this.socket = null;\n    return this.closedPromise;\n  }\n\n  /**\n  * Emits an error event and rejects the open promise if an error is raised on the connection.\n  * @param {Object} event - The event describing the error.\n  */\n  onError(event) {\n    if (this.resolvers.opened) {\n      this.resolvers.opened.rejectWith(event);\n    } else {\n      // only emit errors after the initial open promise has been resolved,\n      // this makes it possible to catch early websocket errors as well\n      // as run-time ones:\n      this.emit('socket-error', event);\n    }\n    this.rejectAllOutstandingResolvers({ code: -1, message: 'Socket error' });\n  }\n\n  /**\n  * Parses the onMessage event on the connection and resolve the promise for the request.\n  * @param {Object} event - The event describing the message.\n  */\n  onMessage(event) {\n    const data = JSON.parse(event.data);\n    this.emit('traffic', 'received', data);\n    if (typeof data.id !== 'undefined') {\n      this.emit('message', data);\n      this.resolvers[data.id].resolveWith(data);\n    } else {\n      this.emit(data.params ? 'notification' : 'message', data);\n    }\n  }\n\n  /**\n  * Rejects all outstanding resolvers.\n  * @param {Object} reason - The reject reason.\n  */\n  rejectAllOutstandingResolvers(reason) {\n    Object.keys(this.resolvers).forEach((id) => {\n      if (id === 'opened' || id === 'closed') {\n        return; // \"opened\" and \"closed\" should not be handled here\n      }\n      const resolver = this.resolvers[id];\n      resolver.rejectWith(reason);\n    });\n  }\n\n  /**\n  * Unregisters a resolver.\n  * @param {Number|String} id - The ID to unregister the resolver with.\n  */\n  unregisterResolver(id) {\n    const resolver = this.resolvers[id];\n    resolver.removeAllListeners();\n    delete this.resolvers[id];\n  }\n\n  /**\n  * Registers a resolver.\n  * @param {Number|String} id - The ID to register the resolver with.\n  * @returns {Function} The promise executor function.\n  */\n  registerResolver(id, resolve, reject) {\n    const resolver = new RPCResolver(id, resolve, reject);\n    this.resolvers[id] = resolver;\n    resolver.on('resolved', resolvedId => this.unregisterResolver(resolvedId));\n    resolver.on('rejected', rejectedId => this.unregisterResolver(rejectedId));\n  }\n\n  /**\n  * Sends data on the socket.\n  * @param {Object} data - The data to send.\n  * @returns {Object} A promise instance.\n  */\n  send(data) {\n    if (!this.socket || this.socket.readyState !== this.socket.OPEN) {\n      return this.Promise.reject(new Error('Not connected'));\n    }\n    this.requestId += 1;\n    data.jsonrpc = '2.0';\n    data.id = this.requestId;\n    return new this.Promise((resolve, reject) => {\n      this.socket.send(JSON.stringify(data));\n      this.emit('traffic', 'sent', data);\n      return this.registerResolver(data.id, resolve, reject);\n    });\n  }\n}\n\nexport default RPC;\n","const ON_ATTACHED_TIMEOUT_MS = 5000;\nconst RPC_CLOSE_MANUAL_SUSPEND = 4000;\n\nclass SuspendResume {\n  /**\n  * Creates a new SuspendResume instance.\n  * @param {Object} options The configuration option for this class.\n  * @param {Promise} options.Promise The promise constructor to use.\n  * @param {RPC} options.rpc The RPC instance to use when communicating towards Engine.\n  * @param {ApiCache} options.apis The ApiCache instance to use.\n  */\n  constructor(options) {\n    Object.assign(this, options);\n    this.isSuspended = false;\n    this.rpc.on('traffic', (dir, data) => {\n      if (dir === 'sent' && data.method === 'OpenDoc') {\n        this.openDocParams = data.params;\n      }\n    });\n  }\n\n  /**\n  * Function used to restore the rpc connection.\n  * @param {Boolean} onlyIfAttached - if true, the returned promise will resolve\n  *                                   only if the session can be re-attached.\n  * @returns {Object} Returns a promise instance.\n  */\n  restoreRpcConnection(onlyIfAttached) {\n    return this.reopen(ON_ATTACHED_TIMEOUT_MS).then((sessionState) => {\n      if (sessionState === 'SESSION_CREATED' && onlyIfAttached) {\n        return this.Promise.reject(new Error('Not attached'));\n      }\n      return this.Promise.resolve();\n    });\n  }\n\n  /**\n  * Function used to restore the global API.\n  * @param {Object} changed - A list where the restored APIs will be added.\n  * @returns {Object} Returns a promise instance.\n  */\n  restoreGlobal(changed) {\n    const global = this.apis.getApisByType('Global').pop();\n    changed.push(global.api);\n    return this.Promise.resolve();\n  }\n\n  /**\n  * Function used to restore the doc API.\n  * @param {String} sessionState - The state of the session, attached or created.\n  * @param {Array} closed - A list where the closed of APIs APIs will be added.\n  * @param {Object} changed - A list where the restored APIs will be added.\n  * @returns {Object} Returns a promise instance.\n  */\n  restoreDoc(closed, changed) {\n    const doc = this.apis.getApisByType('Doc').pop();\n\n    if (!doc) {\n      return this.Promise.resolve();\n    }\n\n    return this.rpc.send({\n      method: 'GetActiveDoc',\n      handle: -1,\n      params: [],\n    }).then((response) => {\n      if (response.error && this.openDocParams) {\n        return this.rpc.send({\n          method: 'OpenDoc',\n          handle: -1,\n          params: this.openDocParams,\n        });\n      }\n      return response;\n    }).then((response) => {\n      if (response.error) {\n        closed.push(doc.api);\n        return this.Promise.resolve();\n      }\n      const handle = response.result.qReturn.qHandle;\n      doc.api.handle = handle;\n      changed.push(doc.api);\n      return this.Promise.resolve(doc.api);\n    });\n  }\n\n  /**\n  * Function used to restore the APIs on the doc.\n  * @param {Object} doc - The doc API on which the APIs we want to restore exist.\n  * @param {Array} closed - A list where the closed of APIs APIs will be added.\n  * @param {Object} changed - A list where the restored APIs will be added.\n  * @returns {Object} Returns a promise instance.\n  */\n  restoreDocObjects(doc, closed, changed) {\n    const tasks = [];\n    const apis = this.apis.getApis()\n      .map(entry => entry.api)\n      .filter(api => api.type !== 'Global' && api.type !== 'Doc');\n\n    if (!doc) {\n      apis.forEach(api => closed.push(api));\n      return this.Promise.resolve();\n    }\n\n    apis.forEach((api) => {\n      const method = SuspendResume.buildGetMethodName(api.type);\n\n      if (!method) {\n        closed.push(api);\n      } else {\n        const request = this.rpc.send({\n          method,\n          handle: doc.handle,\n          params: [api.id],\n        }).then((response) => {\n          if (response.error || !response.result.qReturn.qHandle) {\n            closed.push(api);\n          } else {\n            api.handle = response.result.qReturn.qHandle;\n            changed.push(api);\n          }\n        });\n        tasks.push(request);\n      }\n    });\n    return this.Promise.all(tasks);\n  }\n\n  /**\n  * Set the instance as suspended.\n  */\n  suspend() {\n    this.isSuspended = true;\n    return this.rpc.close(RPC_CLOSE_MANUAL_SUSPEND);\n  }\n\n  /**\n  * Resumes a previously suspended RPC connection, and refreshes the API cache.\n  *                                APIs unabled to be restored has their 'closed'\n  *                                event triggered, otherwise 'changed'.\n  * @param {Boolean} onlyIfAttached if true, resume only if the session was re-attached.\n  * @returns {Promise} Eventually resolved if the RPC connection was successfully resumed,\n  *                    otherwise rejected.\n  */\n  resume(onlyIfAttached) {\n    const changed = [];\n    const closed = [];\n\n    return this.restoreRpcConnection(onlyIfAttached)\n      .then(() => this.restoreGlobal(changed))\n      .then(() => this.restoreDoc(closed, changed))\n      .then(doc => this.restoreDocObjects(doc, closed, changed))\n      .then(() => {\n        this.isSuspended = false;\n        this.apis.clear();\n        closed.forEach((api) => {\n          api.emit('closed');\n          api.removeAllListeners();\n        });\n        changed.forEach((api) => {\n          this.apis.add(api.handle, api);\n          if (api.type !== 'Global') {\n            api.emit('changed');\n          }\n        });\n      })\n      .catch(err => this.rpc.close().then(() => this.Promise.reject(err)));\n  }\n\n  /**\n  * Reopens the connection and waits for the OnConnected notification.\n  * @param {Number} timeout - The time to wait for the OnConnected notification.\n  * @returns {Object} A promise containing the session state (SESSION_CREATED or SESSION_ATTACHED).\n  */\n  reopen(timeout) {\n    let timer;\n    let notificationResolve;\n    let notificationReceived = false;\n    const notificationPromise = new this.Promise((resolve) => { notificationResolve = resolve; });\n\n    const waitForNotification = () => {\n      if (!notificationReceived) {\n        timer = setTimeout(() => notificationResolve('SESSION_CREATED'), timeout);\n      }\n      return notificationPromise;\n    };\n\n    const onNotification = (data) => {\n      if (data.method !== 'OnConnected') return;\n      clearTimeout(timer);\n      notificationResolve(data.params.qSessionState);\n      notificationReceived = true;\n    };\n\n    this.rpc.on('notification', onNotification);\n\n    return this.rpc.open(true)\n      .then(waitForNotification)\n      .then((state) => {\n        this.rpc.removeListener('notification', onNotification);\n        return state;\n      })\n      .catch((err) => {\n        this.rpc.removeListener('notification', onNotification);\n        return this.Promise.reject(err);\n      });\n  }\n\n  /**\n  * Function used to build the get method names for Doc APIs.\n  * @param {String} type - The API type.\n  * @returns {String} Returns the get method name, or undefined if the type cannot be restored.\n  */\n  static buildGetMethodName(type) {\n    if (type === 'Field' || type === 'Variable') {\n      return null;\n    } else if (type === 'GenericVariable') {\n      return 'GetVariableById';\n    }\n    return type.replace('Generic', 'Get');\n  }\n}\n\nexport default SuspendResume;\n","const RETURN_KEY = 'qReturn';\n\nclass Intercept {\n  /**\n  * Create a new Intercept instance.\n  * @param {Object} options The configuration options for this class.\n  * @param {Promise} options.Promise The promise constructor to use.\n  * @param {ApiCache} options.apis The ApiCache instance to use.\n  * @param {Boolean} options.delta Whether to use the delta protocol.\n  * @param {Array} [options.interceptors] Additional interceptors to use.\n  * @param {JSONPatch} [options.JSONPatch] The JSONPatch implementation to use (for testing).\n  */\n  constructor(options) {\n    Object.assign(this, options);\n    this.interceptors = [{\n      onFulfilled: this.processErrorInterceptor,\n    }, {\n      onFulfilled: this.processDeltaInterceptor,\n    }, {\n      onFulfilled: this.processResultInterceptor,\n    }, {\n      onFulfilled: this.processMultipleOutParamInterceptor,\n    }, {\n      onFulfilled: this.processOutInterceptor,\n    }, ...this.interceptors || []];\n  }\n\n  /**\n  * Function used to determine if it is a primitive patch.\n  * @param  {Array}  patches Patches from engine.\n  * @return {Boolean} Returns true if it is a primitive patch.\n  */\n  isPrimitivePatch(patches) {\n    // It's only `add` and `replace` that has a\n    // value property according to the jsonpatch spec\n    return patches.length === 1 &&\n    ['add', 'replace'].indexOf(patches[0].op) !== -1 &&\n    this.isPrimitiveValue(patches[0].value) &&\n    patches[0].path === '/';\n  }\n\n  /**\n  * Function used to determine if it is a primitive value.\n  * @param  {Any} value.\n  * @return {Boolean} Returns true if it is a primitive value.\n  */\n  isPrimitiveValue(value) {\n    return typeof value !== 'undefined' && value !== null && typeof value !== 'object' && !Array.isArray(value);\n  }\n\n  /**\n  * Function used to get a patchee.\n  * @param {Number} handle - The handle.\n  * @param {Array} patches - The patches.\n  * @param {String} cacheId - The cacheId.\n  * @returns {Object} Returns the patchee.\n  */\n  getPatchee(handle, patches, cacheId) {\n    // handle primitive types, e.g. string, int, bool\n    if (this.isPrimitivePatch(patches)) {\n      const value = patches[0].value;\n      this.apis.setPatchee(handle, cacheId, value);\n      return value;\n    }\n\n    let patchee = this.apis.getPatchee(handle, cacheId);\n\n    if (!this.isPrimitiveValue(patchee)) {\n      patchee = patchee || (patches.length && Array.isArray(patches[0].value) ? [] : {});\n      this.applyPatch(patchee, patches);\n    }\n\n    this.apis.setPatchee(handle, cacheId, patchee);\n\n    return patchee;\n  }\n\n  /**\n  * Function used to apply a patch.\n  * @param {Object} patchee - The object to patch.\n  * @param {Array} patches - The list of patches to apply.\n  */\n  applyPatch(patchee, patches) {\n    this.JSONPatch.apply(patchee, patches);\n  }\n\n  /**\n  * Process error interceptor.\n  * @param {Object} session - The session the intercept is being executed on.\n  * @param {Object} request - The JSON-RPC request.\n  * @param {Object} response - The response.\n  * @returns {Object} - Returns the defined error for an error, else the response.\n  */\n  processErrorInterceptor(session, request, response) {\n    if (typeof response.error !== 'undefined') {\n      const data = response.error;\n      const error = new Error(data.message);\n      error.code = data.code;\n      error.parameter = data.parameter;\n      return this.Promise.reject(error);\n    }\n    return response;\n  }\n\n  /**\n  * Process delta interceptor.\n  * @param {Object} session - The session the intercept is being executed on.\n  * @param {Object} request - The JSON-RPC request.\n  * @param {Object} response - The response.\n  * @returns {Object} - Returns the patched response\n  */\n  processDeltaInterceptor(session, request, response) {\n    const result = response.result;\n    if (response.delta) {\n      // when delta is on the response data is expected to be an array of patches\n      const keys = Object.keys(result);\n      for (let i = 0, cnt = keys.length; i < cnt; i += 1) {\n        const key = keys[i];\n        const patches = result[key];\n        if (!Array.isArray(patches)) {\n          return this.Promise.reject(new Error('Unexpected rpc response, expected array of patches'));\n        }\n        result[key] = this.getPatchee(request.handle, patches, `${request.method}-${key}`);\n      }\n      // return a cloned response object to avoid patched object references:\n      return JSON.parse(JSON.stringify(response));\n    }\n    return response;\n  }\n\n  /**\n  * Process result interceptor.\n  * @param {Object} session - The session the intercept is being executed on.\n  * @param {Object} request - The JSON-RPC request.\n  * @param {Object} response - The response.\n  * @returns {Object} - Returns the result property on the response\n  */\n  processResultInterceptor(session, request, response) {\n    return response.result;\n  }\n\n  /**\n  * Processes specific QIX methods that are breaking the protocol specification\n  * and normalizes the response.\n  * @param {Object} session - The session the intercept is being executed on.\n  * @param {Object} request - The JSON-RPC request.\n  * @param {Object} response - The response.\n  * @returns {Object} - Returns the result property on the response\n  */\n  processMultipleOutParamInterceptor(session, request, response) {\n    if (request.method === 'CreateSessionApp' || request.method === 'CreateSessionAppFromApp') {\n      // this method returns multiple out params that we need\n      // to normalize before processing the response further:\n      response[RETURN_KEY].qGenericId = response[RETURN_KEY].qGenericId || response.qSessionAppId;\n    } else if (request.method === 'GetInteract') {\n      // this method returns a qReturn value when it should only return\n      // meta.outKey:\n      delete response[RETURN_KEY];\n    }\n    return response;\n  }\n\n  /**\n  * Process out interceptor.\n  * @param {Object} session - The session the intercept is being executed on.\n  * @param {Object} request - The JSON-RPC request.\n  * @param {Object} response - The result.\n  * @returns {Object} - Returns the out property on result\n  */\n  processOutInterceptor(session, request, response) {\n    if (hasOwnProperty.call(response, RETURN_KEY)) {\n      return response[RETURN_KEY];\n    } else if (request.outKey !== -1) {\n      return response[request.outKey];\n    }\n    return response;\n  }\n\n  /**\n  * Execute the interceptor queue, each interceptor will get the result from\n  * the previous interceptor.\n  * @param {Object} session The session instance to execute against.\n  * @param {Promise} promise The promise to chain on to.\n  * @param {Object} request The JSONRPC request object for the intercepted response.\n  * @returns {Promise}\n  */\n  execute(session, promise, request) {\n    return this.interceptors.reduce((interception, interceptor) =>\n      interception.then(\n        interceptor.onFulfilled && interceptor.onFulfilled.bind(this, session, request),\n        interceptor.onRejected && interceptor.onRejected.bind(this, session, request))\n      , promise,\n    );\n  }\n}\n\nexport default Intercept;\n","import KeyValueCache from './cache';\n\n/**\n* API cache for instances of QIX types, e.g. GenericObject.\n* @extends KeyValueCache\n*/\nclass ApiCache extends KeyValueCache {\n  /**\n  * Adds an API.\n  * @function ApiCache#add\n  * @param {Number} handle - The handle for the API.\n  * @param {*} api - The API.\n  * @returns {{api: *, deltaCache}} The entry.\n  */\n  add(handle, api) {\n    const entry = {\n      api,\n      deltaCache: new KeyValueCache(),\n    };\n    super.add(handle.toString(), entry);\n    api.on('closed', () => this.remove(handle));\n    return entry;\n  }\n\n  /**\n  * Gets an API.\n  * @function ApiCache#getApi\n  * @param {Number} handle - The handle for the API.\n  * @returns {*} The API for the handle.\n  */\n  getApi(handle) {\n    const entry = typeof handle !== 'undefined' ? this.get(handle.toString()) : undefined;\n    return entry && entry.api;\n  }\n\n  /**\n  * Gets a list of APIs.\n  * @function ApiCache#getApis\n  * @returns {Array} The list of entries including `handle` and `api` properties for each entry.\n  */\n  getApis() {\n    return super.getAll().map(entry =>\n      ({\n        handle: entry.key,\n        api: entry.value.api,\n      }),\n    );\n  }\n\n  /**\n  * Gets a list of APIs with a given type.\n  * @function ApiCache#getApisByType\n  * @param {String} type - The type of APIs to get.\n  * @returns {Array} The list of entries including `handle` and `api` properties for each entry.\n  */\n  getApisByType(type) {\n    return this.getApis().filter(entry => entry.api.type === type);\n  }\n\n  /**\n  * Gets a patchee.\n  * @function ApiCache#getPatchee\n  * @param {Number} handle - The handle for the API to patch.\n  * @param {String} method - The method to patch.\n  * @returns {*} The patchee.\n  */\n  getPatchee(handle, method) {\n    const entry = this.get(handle.toString());\n    return entry && entry.deltaCache.get(method);\n  }\n\n  /**\n  * Adds a patchee.\n  * @function ApiCache#addPatchee\n  * @param {Number} handle - The handle for the API to patch.\n  * @param {String} method - The method to patch.\n  * @param {Object} patchee - The patchee to add.\n  */\n  addPatchee(handle, method, patchee) {\n    this.get(handle.toString()).deltaCache.add(method, patchee);\n  }\n\n  /**\n  * Sets a patchee.\n  * @function ApiCache#setPatchee\n  * @param {Number} handle - The handle for the API.\n  * @param {String} method - The method.\n  * @param {Object} patchee - The patchee to add.\n  */\n  setPatchee(handle, method, patchee) {\n    this.get(handle.toString()).deltaCache.set(method, patchee);\n  }\n}\n\nexport default ApiCache;\n","import Patch from './json-patch';\nimport Session from './session';\nimport Schema from './schema';\nimport RPC from './rpc';\nimport SuspendResume from './suspend-resume';\nimport Intercept from './intercept';\nimport ApiCache from './api-cache';\n\n/**\n* Qix service.\n*/\nclass Qix {\n  /**\n  * Function used to get a session.\n  * @param {Configuration} config The configuration object for this session.\n  * @returns {Object} Returns a session instance.\n  */\n  static getSession(config) {\n    const {\n      createSocket,\n      definition,\n      JSONPatch,\n      Promise,\n      protocol,\n      responseInterceptors,\n      url,\n    } = config;\n    const apis = new ApiCache();\n    const intercept = new Intercept({\n      apis,\n      interceptors: responseInterceptors,\n      JSONPatch,\n      Promise,\n    });\n    const rpc = new RPC({ createSocket, Promise, url });\n    const suspendResume = new SuspendResume({ apis, Promise, rpc });\n    const session = new Session({\n      apis,\n      definition,\n      intercept,\n      Promise,\n      protocol,\n      rpc,\n      suspendResume,\n    });\n    return session;\n  }\n\n  /**\n  * Function used to create a QIX session.\n  * @param {Object} config The configuration object for the QIX session.\n  * @returns {Session} Returns a new QIX session.\n  */\n  static create(config) {\n    Qix.configureDefaults(config);\n    config.mixins.forEach((mixin) => {\n      config.definition.registerMixin(mixin);\n    });\n    return Qix.getSession(config);\n  }\n\n  /**\n  * Function used to configure defaults.\n  * @param {Configuration} config The configuration object for how to connect\n  *                               and retrieve end QIX APIs.\n  */\n  static configureDefaults(config) {\n    if (!config) {\n      throw new Error('You need to supply a configuration.');\n    }\n\n    if (!config.Promise && typeof Promise === 'undefined') { // eslint-disable-line no-restricted-globals\n      throw new Error('Your environment has no Promise implementation. You must provide a Promise implementation in the config.');\n    }\n\n    if (typeof config.createSocket !== 'function' && typeof WebSocket === 'function') {\n      config.createSocket = url => new WebSocket(url); // eslint-disable-line no-undef\n    }\n\n    if (typeof config.suspendOnClose === 'undefined') {\n      config.suspendOnClose = false;\n    }\n\n    config.protocol = config.protocol || {};\n    config.protocol.delta = config.protocol.delta || true;\n    config.Promise = config.Promise || Promise; // eslint-disable-line no-restricted-globals\n    config.mixins = config.mixins || [];\n    config.JSONPatch = config.JSONPatch || Patch;\n    config.definition = config.definition || new Schema(config);\n  }\n}\n\nexport default Qix;\n"],"names":["isArray","extend","originalExtend","bind","JSONPatch","Array","isObject","v","isUndef","isFunction","generateValue","val","isSpecialProperty","obj","key","substring","getParent","data","str","seperator","parts","split","slice","numPart","forEach","part","i","length","newPart","isNaN","emptyObject","keys","config","Object","getOwnPropertyDescriptor","configurable","compare","a","b","isIdentical","l","patchArray","original","newA","basePath","patches","oldA","tmpIdx","findIndex","id","idx","qInfo","qId","ii","ll","push","splice","concat","generate","newData","oldVal","tmpPath","apply","patch","parent","path","target","from","op","value","newValues","Error","oldParent","clone","createPatch","toLowerCase","updateObject","EventEmitter","prototype","init","RPC_CLOSE_NORMAL","RPC_CLOSE_MANUAL_SUSPEND","Session","options","session","mixin","rpc","on","onRpcError","onRpcClosed","onRpcMessage","onRpcNotification","onRpcTraffic","onSessionClosed","err","suspendResume","isSuspended","emit","evt","code","suspendOnClose","suspend","then","initiator","response","change","emitHandleChanged","handle","close","emitHandleClosed","method","params","dir","apis","getApis","entry","api","removeAllListeners","clear","args","type","genericType","getApi","definition","create","protocol","delta","add","qHandle","qType","getObjectApi","qGenericId","qGenericType","Promise","reject","globalPromise","open","global","request","babelHelpers.extends","send","retry","promise","intercept","execute","res","handleObjectReferenceResponse","addToPromiseChain","onlyIfAttached","resume","undefined","name","patchedThen","chain","KeyValueCache","entries","map","filter","IGNORE_DELTA_METHODS","SUCCESS_KEY","hasOwnProperty","toCamelCase","symbol","namedParamFacade","base","defaults","babelHelpers.typeof","valid","every","call","Schema","schema","mixins","types","override","cached","typeKey","entryList","get","structs","factory","generateApi","generateDefaultApi","mixinType","mixinNamedParamFacade","customKey","instance","defineProperties","mixinList","fnName","outKey","Out","Name","allowDelta","indexOf","fn","defineProperty","baseFn","wrappedFn","In","reduce","result","item","DefaultValue","namedParamWrapper","RPCResolver","resolve","RPC","resolvers","requestId","openedPromise","force","socket","createSocket","url","onopen","onOpen","onclose","onClose","onerror","onError","onmessage","onMessage","registerResolver","closedPromise","opened","resolveWith","event","closed","rejectAllOutstandingResolvers","message","reason","rejectWith","JSON","parse","resolver","unregisterResolver","resolvedId","rejectedId","readyState","OPEN","jsonrpc","stringify","ON_ATTACHED_TIMEOUT_MS","SuspendResume","openDocParams","reopen","sessionState","changed","getApisByType","pop","doc","error","qReturn","tasks","buildGetMethodName","all","restoreRpcConnection","restoreGlobal","restoreDoc","restoreDocObjects","catch","timeout","timer","notificationResolve","notificationReceived","notificationPromise","waitForNotification","setTimeout","onNotification","qSessionState","state","removeListener","replace","RETURN_KEY","Intercept","interceptors","processErrorInterceptor","processDeltaInterceptor","processResultInterceptor","processMultipleOutParamInterceptor","processOutInterceptor","isPrimitiveValue","cacheId","isPrimitivePatch","setPatchee","patchee","getPatchee","applyPatch","parameter","cnt","qSessionAppId","interception","interceptor","onFulfilled","onRejected","ApiCache","toString","remove","babelHelpers.get","deltaCache","set","Qix","responseInterceptors","configureDefaults","registerMixin","getSession","WebSocket","Patch"],"mappings":"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"}